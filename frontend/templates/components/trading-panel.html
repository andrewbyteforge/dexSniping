<!-- Trading Panel Component
     File: frontend/templates/components/trading-panel.html
     
     Live trading interface with order execution, position management,
     and real-time portfolio tracking -->

<div class="trading-panel">
    <!-- Trading Panel Header -->
    <div class="card border-0 shadow-sm mb-4">
        <div class="card-header bg-gradient-primary text-white">
            <div class="d-flex justify-content-between align-items-center">
                <h5 class="mb-0">
                    <i class="fas fa-chart-line me-2"></i>
                    Live Trading Panel
                </h5>
                <div class="d-flex align-items-center">
                    <span class="badge bg-success me-2">
                        <i class="fas fa-circle pulse"></i> LIVE
                    </span>
                    <button class="btn btn-outline-light btn-sm refresh-portfolio">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Quick Stats -->
        <div class="card-body">
            <div class="row g-3">
                <div class="col-md-3">
                    <div class="stats-card bg-primary-subtle p-3 rounded">
                        <div class="d-flex align-items-center">
                            <div class="stats-icon text-primary me-3">
                                <i class="fas fa-wallet fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-muted">Total Value</h6>
                                <h4 class="mb-0 portfolio-total-value">$12,847.50</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card bg-success-subtle p-3 rounded">
                        <div class="d-flex align-items-center">
                            <div class="stats-icon text-success me-3">
                                <i class="fas fa-dollar-sign fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-muted">Cash Balance</h6>
                                <h4 class="mb-0 portfolio-cash-balance">$5,432.10</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card bg-info-subtle p-3 rounded">
                        <div class="d-flex align-items-center">
                            <div class="stats-icon text-info me-3">
                                <i class="fas fa-chart-area fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-muted">P&L Today</h6>
                                <h4 class="mb-0 portfolio-pnl text-success">+$234.56</h4>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stats-card bg-warning-subtle p-3 rounded">
                        <div class="d-flex align-items-center">
                            <div class="stats-icon text-warning me-3">
                                <i class="fas fa-percentage fa-2x"></i>
                            </div>
                            <div>
                                <h6 class="mb-1 text-muted">Return</h6>
                                <h4 class="mb-0 portfolio-return-pct text-success">+1.86%</h4>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Trading Interface -->
    <div class="row g-4">
        <!-- Quick Trade Panel -->
        <div class="col-lg-4">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-gradient-secondary text-white">
                    <h6 class="mb-0">
                        <i class="fas fa-bolt me-2"></i>
                        Quick Trade
                    </h6>
                </div>
                <div class="card-body">
                    <form id="quick-trade-form">
                        <!-- Token Selection -->
                        <div class="mb-3">
                            <label class="form-label">Select Token</label>
                            <select class="form-select token-select" name="tokenAddress" required>
                                <option value="">Choose a token...</option>
                                <option value="0xA0b86a33E6b0bbab0d4f05A64a5E4A6eA4C2E4e4">ETH</option>
                                <option value="0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174">USDC</option>
                                <option value="0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270">MATIC</option>
                                <option value="0x1BFD67037B42Cf73acF2047067bd4F2C47D9BfD6">WBTC</option>
                            </select>
                        </div>
                        
                        <!-- Trade Type Tabs -->
                        <ul class="nav nav-pills nav-fill mb-3" role="tablist">
                            <li class="nav-item" role="presentation">
                                <button class="nav-link active" data-bs-toggle="pill" data-bs-target="#buy-tab" type="button">
                                    <i class="fas fa-arrow-up text-success me-1"></i> BUY
                                </button>
                            </li>
                            <li class="nav-item" role="presentation">
                                <button class="nav-link" data-bs-toggle="pill" data-bs-target="#sell-tab" type="button">
                                    <i class="fas fa-arrow-down text-danger me-1"></i> SELL
                                </button>
                            </li>
                        </ul>
                        
                        <div class="tab-content">
                            <!-- Buy Tab -->
                            <div class="tab-pane fade show active" id="buy-tab">
                                <div class="mb-3">
                                    <label class="form-label">Amount (USD)</label>
                                    <div class="input-group">
                                        <span class="input-group-text">$</span>
                                        <input type="number" 
                                               class="form-control trade-amount" 
                                               name="buyAmount" 
                                               placeholder="0.00" 
                                               min="10" 
                                               max="5000" 
                                               step="0.01">
                                        <div class="invalid-feedback"></div>
                                    </div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Slippage Tolerance (%)</label>
                                    <select class="form-select slippage-input" name="slippage">
                                        <option value="0.005">0.5%</option>
                                        <option value="0.01" selected>1.0%</option>
                                        <option value="0.02">2.0%</option>
                                        <option value="0.03">3.0%</option>
                                        <option value="0.05">5.0%</option>
                                    </select>
                                </div>
                                
                                <button type="button" class="btn btn-success w-100 btn-lg btn-buy">
                                    <i class="fas fa-arrow-up me-2"></i>
                                    Buy Token
                                    <div class="spinner-border spinner-border-sm ms-2 trading-spinner d-none"></div>
                                </button>
                            </div>
                            
                            <!-- Sell Tab -->
                            <div class="tab-pane fade" id="sell-tab">
                                <div class="mb-3">
                                    <label class="form-label">Amount (Tokens)</label>
                                    <input type="number" 
                                           class="form-control trade-amount" 
                                           name="sellAmount" 
                                           placeholder="0.0000" 
                                           min="0.0001" 
                                           step="0.0001">
                                    <div class="form-text">Available: <span class="available-balance">0.0000</span></div>
                                    <div class="invalid-feedback"></div>
                                </div>
                                
                                <div class="mb-3">
                                    <label class="form-label">Slippage Tolerance (%)</label>
                                    <select class="form-select slippage-input" name="slippage">
                                        <option value="0.005">0.5%</option>
                                        <option value="0.01" selected>1.0%</option>
                                        <option value="0.02">2.0%</option>
                                        <option value="0.03">3.0%</option>
                                        <option value="0.05">5.0%</option>
                                    </select>
                                </div>
                                
                                <button type="button" class="btn btn-danger w-100 btn-lg btn-sell">
                                    <i class="fas fa-arrow-down me-2"></i>
                                    Sell Token
                                    <div class="spinner-border spinner-border-sm ms-2 trading-spinner d-none"></div>
                                </button>
                            </div>
                        </div>
                    </form>
                    
                    <!-- Advanced Options -->
                    <div class="mt-3 pt-3 border-top">
                        <button class="btn btn-outline-primary btn-sm w-100" 
                                data-bs-toggle="modal" 
                                data-bs-target="#limit-order-modal">
                            <i class="fas fa-cog me-1"></i>
                            Advanced Order (Limit/Stop)
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Current Positions -->
        <div class="col-lg-8">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-gradient-info text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <i class="fas fa-chart-pie me-2"></i>
                            Current Positions
                        </h6>
                        <button class="btn btn-outline-light btn-sm refresh-portfolio">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0" id="positions-table">
                            <thead class="table-dark">
                                <tr>
                                    <th>Token</th>
                                    <th>Amount</th>
                                    <th>Price</th>
                                    <th>Value</th>
                                    <th>P&L</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                <!-- Positions will be populated by JavaScript -->
                                <tr>
                                    <td colspan="6" class="text-center text-muted py-4">
                                        <i class="fas fa-chart-pie fa-2x mb-2"></i>
                                        <br>Loading positions...
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Active Orders & History -->
    <div class="row g-4 mt-2">
        <!-- Active Orders -->
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-gradient-warning text-dark">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <i class="fas fa-clock me-2"></i>
                            Active Orders
                        </h6>
                        <span class="badge bg-dark active-orders-count">0</span>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0" id="active-orders-table">
                            <thead class="table-dark">
                                <tr>
                                    <th>Order ID</th>
                                    <th>Side</th>
                                    <th>Type</th>
                                    <th>Amount</th>
                                    <th>Price</th>
                                    <th>Status</th>
                                    <th>Action</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="7" class="text-center text-muted py-4">
                                        <i class="fas fa-clock fa-2x mb-2"></i>
                                        <br>No active orders
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Recent Order History -->
        <div class="col-lg-6">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-gradient-secondary text-white">
                    <div class="d-flex justify-content-between align-items-center">
                        <h6 class="mb-0">
                            <i class="fas fa-history me-2"></i>
                            Recent Orders
                        </h6>
                        <button class="btn btn-outline-light btn-sm refresh-orders">
                            <i class="fas fa-sync-alt"></i>
                        </button>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table table-hover mb-0" id="order-history-table">
                            <thead class="table-dark">
                                <tr>
                                    <th>Order ID</th>
                                    <th>Side</th>
                                    <th>Amount</th>
                                    <th>Price</th>
                                    <th>Status</th>
                                    <th>Date</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td colspan="6" class="text-center text-muted py-4">
                                        <i class="fas fa-history fa-2x mb-2"></i>
                                        <br>No order history
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Limit Order Modal -->
<div class="modal fade" id="limit-order-modal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header bg-primary text-white">
                <h5 class="modal-title">
                    <i class="fas fa-cog me-2"></i>
                    Advanced Order
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <form id="limit-order-form">
                    <div class="row g-3">
                        <div class="col-md-6">
                            <label class="form-label">Order Type</label>
                            <select class="form-select" name="orderType" required>
                                <option value="limit">Limit Order</option>
                                <option value="stop_loss">Stop Loss</option>
                                <option value="take_profit">Take Profit</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Side</label>
                            <select class="form-select" name="side" required>
                                <option value="buy">Buy</option>
                                <option value="sell">Sell</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Amount</label>
                            <input type="number" class="form-control" name="amount" placeholder="0.0000" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Limit Price ($)</label>
                            <input type="number" class="form-control" name="limitPrice" placeholder="0.00" step="0.01" required>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Expires In</label>
                            <select class="form-select" name="expiresIn">
                                <option value="60">1 Hour</option>
                                <option value="360">6 Hours</option>
                                <option value="720">12 Hours</option>
                                <option value="1440">24 Hours</option>
                                <option value="10080">7 Days</option>
                            </select>
                        </div>
                        <div class="col-md-6">
                            <label class="form-label">Token</label>
                            <select class="form-select" name="tokenAddress" required>
                                <option value="">Select token...</option>
                                <option value="0xA0b86a33E6b0bbab0d4f05A64a5E4A6eA4C2E4e4">ETH</option>
                                <option value="0x2791Bca1f2de4661ED88A30C99A7a9449Aa84174">USDC</option>
                                <option value="0x0d500B1d8E8eF31E21C99d1Db9A6444d3ADf1270">MATIC</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-4 p-3 bg-light rounded">
                        <h6>Order Summary</h6>
                        <div class="row">
                            <div class="col-6">
                                <small class="text-muted">Estimated Cost:</small>
                                <div class="fw-bold order-estimated-cost">$0.00</div>
                            </div>
                            <div class="col-6">
                                <small class="text-muted">Estimated Fees:</small>
                                <div class="fw-bold order-estimated-fees">$0.00</div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="submit" form="limit-order-form" class="btn btn-primary">
                    <i class="fas fa-paper-plane me-2"></i>
                    Place Order
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Trade Confirmation Modal -->
<div class="modal fade" id="trade-confirmation-modal" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Confirm Trade</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="trade-confirmation-details">
                    <!-- Trade details will be populated by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary confirm-trade-btn">
                    Confirm Trade
                </button>
            </div>
        </div>
    </div>
</div>

<style>
.trading-panel .stats-card {
    transition: transform 0.2s ease;
}

.trading-panel .stats-card:hover {
    transform: translateY(-2px);
}

.pulse {
    animation: pulse 2s infinite;
}

@keyframes pulse {
    0% { opacity: 1; }
    50% { opacity: 0.5; }
    100% { opacity: 1; }
}

.nav-pills .nav-link {
    border-radius: 8px;
    font-weight: 500;
}

.nav-pills .nav-link.active {
    background: linear-gradient(45deg, #28a745, #20c997);
}

.table-hover tbody tr:hover {
    background-color: rgba(0,123,255,0.1);
}

.trading-spinner {
    width: 1rem;
    height: 1rem;
}

.available-balance {
    font-weight: 600;
    color: #28a745;
}

.order-estimated-cost,
.order-estimated-fees {
    font-size: 1.1em;
    color: #495057;
}

.card-header {
    border: none;
}

.bg-gradient-primary {
    background: linear-gradient(45deg, #007bff, #0056b3);
}

.bg-gradient-secondary {
    background: linear-gradient(45deg, #6c757d, #495057);
}

.bg-gradient-info {
    background: linear-gradient(45deg, #17a2b8, #138496);
}

.bg-gradient-warning {
    background: linear-gradient(45deg, #ffc107, #e0a800);
}

.bg-primary-subtle {
    background-color: rgba(13, 110, 253, 0.1);
}

.bg-success-subtle {
    background-color: rgba(25, 135, 84, 0.1);
}

.bg-info-subtle {
    background-color: rgba(13, 202, 240, 0.1);
}

.bg-warning-subtle {
    background-color: rgba(255, 193, 7, 0.1);
}
</style>